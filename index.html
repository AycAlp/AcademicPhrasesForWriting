<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Academic Phrases for the Introduction</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.js"></script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;

        // â”€â”€â”€ Supabase Client â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        const sb = supabase.createClient(
            'https://xxhknuwjjzrctscupgwv.supabase.co',
            'sb_publishable_ZUayxZOtbvGpaYcNcL6HiA_3OkkTYqy'
        );

        // â”€â”€â”€ Icons â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        const EyeIcon = ({ className, onClick }) => (
            <svg onClick={onClick} className={className} xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/>
            </svg>
        );
        const EyeOffIcon = ({ className, onClick }) => (
            <svg onClick={onClick} className={className} xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"/><path d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"/><path d="M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"/><line x1="2" x2="22" y1="2" y2="22"/>
            </svg>
        );
        const LockIcon = ({ className }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <rect width="18" height="11" x="3" y="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/>
            </svg>
        );
        const MailIcon = ({ className }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <rect width="20" height="16" x="2" y="4" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/>
            </svg>
        );
        const UserIcon = ({ className }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="12" cy="8" r="5"/><path d="M20 21a8 8 0 1 0-16 0"/>
            </svg>
        );
        const LogOutIcon = ({ className }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" x2="9" y1="12" y2="12"/>
            </svg>
        );

        // â”€â”€â”€ Input Field â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        const Field = ({ label, type = 'text', value, onChange, icon: Icon, error, placeholder, rightEl }) => (
            <div className="mb-4">
                <label className="block text-sm font-medium text-gray-700 mb-1">{label}</label>
                <div className="relative">
                    {Icon && <Icon className="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none" />}
                    <input
                        type={type}
                        value={value}
                        onChange={e => onChange(e.target.value)}
                        placeholder={placeholder}
                        className={`w-full ${Icon ? 'pl-10' : 'pl-3'} ${rightEl ? 'pr-10' : 'pr-3'} py-2.5 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none transition ${error ? 'border-red-400 bg-red-50' : 'border-gray-300'}`}
                    />
                    {rightEl && <div className="absolute right-3 top-1/2 -translate-y-1/2 cursor-pointer text-gray-400 hover:text-gray-600">{rightEl}</div>}
                </div>
                {error && <p className="text-red-500 text-xs mt-1">{error}</p>}
            </div>
        );

        // â”€â”€â”€ Login â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        const LoginForm = ({ onSuccess, goTo }) => {
            const [email, setEmail] = useState('');
            const [password, setPassword] = useState('');
            const [showPw, setShowPw] = useState(false);
            const [errors, setErrors] = useState({});
            const [serverErr, setServerErr] = useState('');

            const validate = () => {
                const e = {};
                if (!email) e.email = 'Email is required';
                else if (!/\S+@\S+\.\S+/.test(email)) e.email = 'Enter a valid email';
                if (!password) e.password = 'Password is required';
                return e;
            };

            const [loading, setLoading] = useState(false);

            const submit = async () => {
                const e = validate();
                setErrors(e);
                if (Object.keys(e).length) return;
                setLoading(true);
                const { error } = await sb.auth.signInWithPassword({ email, password });
                setLoading(false);
                if (error) { setServerErr(error.message); return; }
                // onAuthStateChange in the parent will update currentUser
            };

            return (
                <div>
                    <h2 className="text-2xl font-bold text-gray-800 mb-1">Welcome back</h2>
                    <p className="text-gray-500 text-sm mb-6">Sign in to your account</p>
                    {serverErr && <div className="mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-600 text-sm">{serverErr}</div>}
                    <Field label="Email" value={email} onChange={v => { setEmail(v); setServerErr(''); }} icon={MailIcon} error={errors.email} placeholder="you@example.com" />
                    <Field label="Password" type={showPw ? 'text' : 'password'} value={password} onChange={v => { setPassword(v); setServerErr(''); }} icon={LockIcon} error={errors.password} placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
                        rightEl={showPw ? <EyeOffIcon onClick={() => setShowPw(false)} /> : <EyeIcon onClick={() => setShowPw(true)} />}
                    />
                    <div className="text-right mb-5">
                        <button onClick={() => goTo('forgot')} className="text-sm text-indigo-600 hover:underline">Forgot password?</button>
                    </div>
                    <button onClick={submit} disabled={loading} className="w-full py-2.5 bg-indigo-600 hover:bg-indigo-700 disabled:opacity-60 text-white font-semibold rounded-lg transition">
                        {loading ? 'Signing inâ€¦' : 'Sign In'}
                    </button>
                    <p className="text-center text-sm text-gray-500 mt-5">Don't have an account? <button onClick={() => goTo('signup')} className="text-indigo-600 font-medium hover:underline">Sign up</button></p>
                </div>
            );
        };

        // â”€â”€â”€ Signup â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        const SignupForm = ({ onSuccess, goTo }) => {
            const [name, setName] = useState('');
            const [email, setEmail] = useState('');
            const [password, setPassword] = useState('');
            const [confirm, setConfirm] = useState('');
            const [showPw, setShowPw] = useState(false);
            const [errors, setErrors] = useState({});
            const [serverErr, setServerErr] = useState('');

            const validate = () => {
                const e = {};
                if (!name.trim()) e.name = 'Name is required';
                if (!email) e.email = 'Email is required';
                else if (!/\S+@\S+\.\S+/.test(email)) e.email = 'Enter a valid email';
                if (!password) e.password = 'Password is required';
                else if (password.length < 6) e.password = 'Minimum 6 characters';
                if (!confirm) e.confirm = 'Please confirm your password';
                else if (confirm !== password) e.confirm = 'Passwords do not match';
                return e;
            };

            const [loading, setLoading] = useState(false);

            const submit = async () => {
                const e = validate();
                setErrors(e);
                if (Object.keys(e).length) return;
                setLoading(true);
                const { error } = await sb.auth.signUp({
                    email,
                    password,
                    options: { data: { name: name.trim() } }
                });
                setLoading(false);
                if (error) { setServerErr(error.message); return; }
                // onAuthStateChange in the parent will update currentUser
            };

            return (
                <div>
                    <h2 className="text-2xl font-bold text-gray-800 mb-1">Create account</h2>
                    <p className="text-gray-500 text-sm mb-6">Join us today â€” it's free</p>
                    {serverErr && <div className="mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-600 text-sm">{serverErr}</div>}
                    <Field label="Full Name" value={name} onChange={v => { setName(v); setServerErr(''); }} icon={UserIcon} error={errors.name} placeholder="Jane Doe" />
                    <Field label="Email" value={email} onChange={v => { setEmail(v); setServerErr(''); }} icon={MailIcon} error={errors.email} placeholder="you@example.com" />
                    <Field label="Password" type={showPw ? 'text' : 'password'} value={password} onChange={setPassword} icon={LockIcon} error={errors.password} placeholder="Min. 6 characters"
                        rightEl={showPw ? <EyeOffIcon onClick={() => setShowPw(false)} /> : <EyeIcon onClick={() => setShowPw(true)} />}
                    />
                    <Field label="Confirm Password" type={showPw ? 'text' : 'password'} value={confirm} onChange={setConfirm} icon={LockIcon} error={errors.confirm} placeholder="Repeat password" />
                    <button onClick={submit} disabled={loading} className="w-full py-2.5 bg-indigo-600 hover:bg-indigo-700 disabled:opacity-60 text-white font-semibold rounded-lg transition mt-1">
                        {loading ? 'Creating accountâ€¦' : 'Create Account'}
                    </button>
                    <p className="text-center text-sm text-gray-500 mt-5">Already have an account? <button onClick={() => goTo('login')} className="text-indigo-600 font-medium hover:underline">Sign in</button></p>
                </div>
            );
        };

        // â”€â”€â”€ Forgot Password â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        const ForgotForm = ({ goTo }) => {
            const [email, setEmail] = useState('');
            const [error, setError] = useState('');
            const [sent, setSent] = useState(false);

            const [loading, setLoading] = useState(false);

            const submit = async () => {
                if (!email) { setError('Email is required'); return; }
                if (!/\S+@\S+\.\S+/.test(email)) { setError('Enter a valid email'); return; }
                setLoading(true);
                const { error } = await sb.auth.resetPasswordForEmail(email);
                setLoading(false);
                if (error) { setError(error.message); return; }
                setSent(true);
            };

            if (sent) return (
                <div className="text-center py-4">
                    <div className="text-5xl mb-4">ðŸ“¬</div>
                    <h2 className="text-xl font-bold text-gray-800 mb-2">Check your inbox</h2>
                    <p className="text-gray-500 text-sm mb-6">A password reset link has been sent to <strong>{email}</strong>.<br/>
                    <span className="text-xs text-gray-400">Check your inbox and follow the link.</span></p>
                    <button onClick={() => goTo('login')} className="text-indigo-600 font-medium hover:underline text-sm">Back to Sign In</button>
                </div>
            );

            return (
                <div>
                    <h2 className="text-2xl font-bold text-gray-800 mb-1">Reset password</h2>
                    <p className="text-gray-500 text-sm mb-6">We'll send a reset link to your email</p>
                    <Field label="Email" value={email} onChange={v => { setEmail(v); setError(''); }} icon={MailIcon} error={error} placeholder="you@example.com" />
                    <button onClick={submit} disabled={loading} className="w-full py-2.5 bg-indigo-600 hover:bg-indigo-700 disabled:opacity-60 text-white font-semibold rounded-lg transition">
                        {loading ? 'Sendingâ€¦' : 'Send Reset Link'}
                    </button>
                    <p className="text-center text-sm text-gray-500 mt-5"><button onClick={() => goTo('login')} className="text-indigo-600 font-medium hover:underline">Back to Sign In</button></p>
                </div>
            );
        };

        // â”€â”€â”€ Auth Shell â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        const AuthShell = ({ view, setView, onSuccess }) => (
            <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4">
                <div className="bg-white rounded-2xl shadow-xl w-full max-w-md p-8">
                    <div className="flex items-center gap-2 mb-8">
                        <div className="w-8 h-8 bg-indigo-600 rounded-lg flex items-center justify-center">
                            <svg className="w-5 h-5 text-white" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"/></svg>
                        </div>
                        <span className="font-bold text-gray-800">Academic Phrases</span>
                    </div>
                    {view === 'login'  && <LoginForm  onSuccess={onSuccess} goTo={setView} />}
                    {view === 'signup' && <SignupForm  onSuccess={onSuccess} goTo={setView} />}
                    {view === 'forgot' && <ForgotForm  goTo={setView} />}
                </div>
            </div>
        );

        // Lucide React icons as inline SVG components
        const Heart = ({ className, fill = "none", onClick }) => (
            <svg onClick={onClick} className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill={fill} stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/>
            </svg>
        );
        
        const ChevronDown = ({ className }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="m6 9 6 6 6-6"/>
            </svg>
        );
        
        const ChevronUp = ({ className }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="m18 15-6-6-6 6"/>
            </svg>
        );
        
        const Search = ({ className }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/>
            </svg>
        );
        
        const Star = ({ className }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
            </svg>
        );
        
        const Book = ({ className }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"/>
            </svg>
        );
        
        const X = ({ className }) => (
            <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M18 6 6 18"/><path d="m6 6 12 12"/>
            </svg>
        );

        // â”€â”€â”€ Email Favorites Button â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        const EmailFavoritesButton = ({ user }) => {
            const [status, setStatus] = useState('idle'); // idle | sending | sent | error
            const [errMsg, setErrMsg] = useState('');

            const send = async () => {
                setStatus('sending');
                const { data: { session } } = await sb.auth.getSession();
                const res = await fetch(
                    'https://xxhknuwjjzrctscupgwv.supabase.co/functions/v1/send-favorites',
                    {
                        method: 'POST',
                        headers: {
                            'Authorization': `Bearer ${session.access_token}`,
                            'Content-Type': 'application/json'
                        }
                    }
                );
                if (res.ok) {
                    setStatus('sent');
                    setTimeout(() => setStatus('idle'), 5000);
                } else {
                    const body = await res.json().catch(() => ({}));
                    setErrMsg(body.error || 'Something went wrong.');
                    setStatus('error');
                    setTimeout(() => setStatus('idle'), 5000);
                }
            };

            return (
                <div className="flex flex-col items-end gap-1 mb-2">
                    <button
                        onClick={send}
                        disabled={status === 'sending'}
                        className="flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 disabled:opacity-60 text-white text-sm font-medium rounded-lg transition"
                    >
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="20" height="16" x="2" y="4" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></svg>
                        {status === 'sending' ? 'Sendingâ€¦' : 'Email my favourites'}
                    </button>
                    {status === 'sent' && (
                        <span className="text-green-600 text-xs">âœ“ Sent to {user.email}</span>
                    )}
                    {status === 'error' && (
                        <span className="text-red-500 text-xs">{errMsg}</span>
                    )}
                </div>
            );
        };

        const AcademicPhrasesApp = () => {
            const [currentUser, setCurrentUser] = useState(null);
            const [authLoading, setAuthLoading] = useState(true);
            const [authView, setAuthView] = useState('login');
            const [favorites, setFavorites] = useState([]);
            const [expandedCategories, setExpandedCategories] = useState({});
            const [searchTerm, setSearchTerm] = useState('');
            const [activeTab, setActiveTab] = useState('browse');
            const [selectedPhrase, setSelectedPhrase] = useState(null);

            // â”€â”€ Listen for Supabase auth changes â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            useEffect(() => {
                sb.auth.getSession().then(({ data: { session } }) => {
                    setCurrentUser(session?.user ?? null);
                    setAuthLoading(false);
                });
                const { data: { subscription } } = sb.auth.onAuthStateChange((_event, session) => {
                    setCurrentUser(session?.user ?? null);
                });
                return () => subscription.unsubscribe();
            }, []);

            // â”€â”€ Load favorites from Supabase when user logs in â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            useEffect(() => {
                if (!currentUser) { setFavorites([]); return; }
                sb.from('favorites')
                    .select('*')
                    .order('created_at', { ascending: true })
                    .then(({ data }) => setFavorites(data || []));
            }, [currentUser]);

            // Sample sentences for each phrase pattern
            const getSampleSentence = (phrase) => {
                const samples = {
                    'is fundamental to': 'Effective communication is fundamental to successful teamwork in any organization.',
                    'has a pivotal role in': 'Technology has a pivotal role in shaping modern education systems.',
                    'is frequently prescribed for': 'This medication is frequently prescribed for patients with chronic pain.',
                    'is fast becoming a key instrument in': 'Artificial intelligence is fast becoming a key instrument in medical diagnosis.',
                    'plays a critical role in the maintenance of': 'Regular exercise plays a critical role in the maintenance of cardiovascular health.',
                    'have emerged as powerful platforms for': 'Social media networks have emerged as powerful platforms for political mobilization.',
                    'is essential for a wide range of': 'Digital literacy is essential for a wide range of professional careers.',
                    'can play an important role in addressing the issue of': 'Renewable energy can play an important role in addressing the issue of climate change.',
                    'plays a crucial role in regulating': 'The liver plays a crucial role in regulating blood sugar levels.',
                    'is a common condition which has considerable impact on': 'Depression is a common condition which has considerable impact on quality of life.',
                    'has become a central issue for': 'Data privacy has become a central issue for technology companies.',
                    'is among the most important factors for': 'Early childhood education is among the most important factors for long-term academic success.',
                    'is important for a wide range of': 'Statistical analysis is important for a wide range of scientific research.',
                    'is a growing body of literature that recognises the importance of': 'There is a growing body of literature that recognises the importance of mental health in the workplace.',
                    'is an important component in': 'Carbon dioxide is an important component in the Earth\'s climate system.',
                    'has been thought of as a key factor in': 'Investment in infrastructure has been thought of as a key factor in economic development.',
                    'are one of the most widely used': 'Antibiotics are one of the most widely used groups of medications in modern medicine.',
                    
                    'A key aspect of': 'A key aspect of sustainable development is balancing economic growth with environmental protection.',
                    'is of interest because': 'This phenomenon is of interest because it challenges existing theoretical frameworks.',
                    'is a classic problem in': 'The traveling salesman problem is a classic problem in computer science.',
                    'A primary concern of': 'A primary concern of urban planning is ensuring adequate housing for all residents.',
                    'is a dominant feature of': 'High unemployment is a dominant feature of post-industrial economies.',
                    'is an important aspect of': 'Cultural sensitivity is an important aspect of international business.',
                    'is a fundamental property of': 'Plasticity is a fundamental property of neural networks.',
                    'are central to': 'The concepts of supply and demand are central to economic theory.',
                    'is at the heart of our understanding of': 'The scientific method is at the heart of our understanding of the natural world.',
                    'is a continuing concern within': 'Investigating gender inequality is a continuing concern within sociology.',
                    'is a major area of interest within': 'Machine learning is a major area of interest within artificial intelligence.',
                    'has been studied by many researchers using': 'Climate change has been studied by many researchers using various modeling techniques.',
                    'has been an object of research since': 'Quantum mechanics has been an object of research since the early 20th century.',
                    'has been the subject of many classic studies in': 'Memory retention has been the subject of many classic studies in cognitive psychology.',
                    'has been instrumental in our understanding of': 'The discovery of DNA structure has been instrumental in our understanding of genetics.',
                    'provides a useful account of how': 'The theory of evolution provides a useful account of how species adapt to their environments.',
                    'is the concept of': 'Central to the entire discipline of economics is the concept of scarcity.',
                    'is an increasingly important area in': 'Cybersecurity is an increasingly important area in information technology.',
                    'has long been a question of great interest in': 'The nature versus nurture debate has long been a question of great interest in psychology.',
                    
                    'have subscribed to the belief that': 'Traditionally, educators have subscribed to the belief that rote learning is essential.',
                    'was one of the most important events of': 'The oil crisis was one of the most important events of the 1970s.',
                    'there has been an increasing interest in': 'In recent years, there has been an increasing interest in sustainable architecture.',
                    'seems to have heightened the need for': 'Recent developments in cybersecurity seem to have heightened the need for stronger regulations.',
                    'have seen a growing trend towards': 'The last two decades have seen a growing trend towards remote work arrangements.',
                    'have shown an increased interest in': 'Recently, researchers have shown an increased interest in gut microbiome research.',
                    'has been a dramatic increase in': 'Over the past century, there has been a dramatic increase in global life expectancy.',
                    'have led to a proliferation of studies that': 'Recent trends in gene editing have led to a proliferation of studies that explore CRISPR applications.',
                    'proved an important': 'The epistolary novel proved an important literary genre in the early Victorian period.',
                    'has seen the rapid development of': 'The past decade has seen the rapid development of renewable energy technologies.',
                    'has been attracting a lot of interest': 'Since it was reported in 2005, graphene has been attracting a lot of interest.',
                    'has been presented around the theme of': 'A considerable literature has been presented around the theme of organizational culture.',
                    
                    'One of the main obstacles': 'One of the main obstacles to implementing universal healthcare is the financial burden on governments.',
                    'One of the greatest challenges': 'One of the greatest challenges facing modern agriculture is water scarcity.',
                    'A key issue is': 'A key issue is the safe disposal of nuclear waste materials.',
                    'The main disadvantage of': 'The main disadvantage of solar energy is its dependence on weather conditions.',
                    'is associated with increased risk of': 'Smoking is associated with increased risk of cardiovascular disease.',
                    'is a common disorder characterised by': 'Anxiety is a common disorder characterised by persistent worry and fear.',
                    'can impair': 'It is now well established that chronic stress can impair immune system function.',
                    'is a common, chronic disease of': 'Asthma is a common, chronic disease of childhood affecting millions globally.',
                    'has led to the declines in': 'Habitat loss has led to the declines in the populations of many bird species.',
                    'is a growing public health concern': 'Antibiotic resistance is a growing public health concern worldwide.',
                    'is one of the most frequently stated problems with': 'Poor user interface is one of the most frequently stated problems with legacy software systems.',
                    
                    'A much debated question seems to be whether': 'A much debated question seems to be whether artificial intelligence will replace human workers.',
                    'One major issue in early': 'One major issue in early stem cell research concerned ethical considerations.',
                    'there has been little agreement on what': 'To date there has been little agreement on what constitutes effective teacher training.',
                    'has grown in importance in light of': 'The issue has grown in importance in light of recent climate-related disasters.',
                    'the relative importance of': 'In the literature on child development, the relative importance of genetics is debated.',
                    'has already drawn attention to the paradox in': 'One observer has already drawn attention to the paradox in modern consumer behavior.',
                    'have been raised about the use of': 'Questions have been raised about the use of animal subjects in cosmetics testing.',
                    'a debate is taking place between': 'In many universities, a debate is taking place between traditionalists and reformers concerning curriculum design.',
                    'continues about the best strategies for': 'Debate continues about the best strategies for the management of chronic pain.',
                    'has recently been challenged by': 'This concept has recently been challenged by neuroscience studies demonstrating brain plasticity.',
                    
                    'This paper argues that': 'This paper argues that social media has fundamentally altered political discourse.',
                    'The central thesis of this paper is that': 'The central thesis of this paper is that climate change requires immediate global action.',
                    
                    'The specific objective of this study was to': 'The specific objective of this study was to examine the effects of sleep deprivation on cognitive performance.',
                    'An objective of this study was to investigate': 'An objective of this study was to investigate the relationship between diet and heart disease.',
                    'This thesis will examine': 'This thesis will examine the way in which the digital revolution has transformed education.',
                    'set out to investigate': 'This study set out to investigate the usefulness of telemedicine in rural healthcare.',
                    'seeks to explain': 'This dissertation seeks to explain the development of democratic institutions in post-colonial states.',
                    'seeks to examine': 'This case study seeks to examine the changing nature of workplace dynamics.',
                    'are to determine whether': 'The objectives of this research are to determine whether remote learning is as effective as traditional methods.',
                    
                    'will refer to': 'Throughout this paper, the term "digital native" will refer to individuals born after 1990.',
                    'can be defined as follows': 'According to Smith (2002), sustainability can be defined as follows: "meeting present needs without compromising future generations."',
                    'will be used to refer to': 'In this article, the abbreviation AI will be used to refer to artificial intelligence.',
                    'is a relatively new name for': 'The term "gig economy" is a relatively new name for freelance work arrangements.'
                };

                // Try to find exact match first
                for (let key in samples) {
                    if (phrase.includes(key)) {
                        return samples[key];
                    }
                }
                
                return `This phrase can be used to ${phrase.toLowerCase()} in academic writing contexts.`;
            };

            const phrasesData = [
                {
                    category: "Establishing Topic Importance for the World",
                    phrases: [
                        "X is fundamental to â€¦",
                        "X has a pivotal role in â€¦",
                        "X is frequently prescribed for â€¦",
                        "X is fast becoming a key instrument in ...",
                        "X plays a critical role in the maintenance of â€¦",
                        "Xs have emerged as powerful platforms for â€¦",
                        "X is essential for a wide range of technologies.",
                        "X can play an important role in addressing the issue of â€¦",
                        "There is evidence that X plays a crucial role in regulating â€¦",
                        "X is a common condition which has considerable impact on â€¦",
                        "In the new global economy, X has become a central issue for ...",
                        "Evidence suggests that X is among the most important factors for â€¦",
                        "X is important for a wide range of scientific and industrial processes.",
                        "There is a growing body of literature that recognises the importance of â€¦",
                        "X is an important component in the climate system, and plays a key role in Y.",
                        "In the history of development economics, X has been thought of as a key factor in â€¦",
                        "Xs are one of the most widely used groups of Y and have been extensively used for â€¦"
                    ]
                },
                {
                    category: "Establishing Topic Importance for the Discipline",
                    phrases: [
                        "A key aspect of X is â€¦",
                        "X is of interest because â€¦",
                        "X is a classic problem in â€¦",
                        "A primary concern of X is â€¦",
                        "X is a dominant feature of â€¦",
                        "X is an important aspect of â€¦",
                        "X is a fundamental property of â€¦",
                        "The concepts of X and Y are central to â€¦",
                        "X is at the heart of our understanding of â€¦",
                        "Investigating X is a continuing concern within â€¦",
                        "X is a major area of interest within the field of â€¦",
                        "X has been studied by many researchers using â€¦",
                        "X has been an object of research since the 1960s.",
                        "X has been the subject of many classic studies in â€¦",
                        "X has been instrumental in our understanding of â€¦",
                        "The theory of X provides a useful account of how â€¦",
                        "Central to the entire discipline of X is the concept of â€¦",
                        "X is an increasingly important area in applied linguistics.",
                        "X has long been a question of great interest in a wide range of fields."
                    ]
                },
                {
                    category: "Establishing Topic Importance (Time Frame)",
                    phrases: [
                        "Traditionally, Xs have subscribed to the belief that â€¦",
                        "One of the most important events of the 1970s was â€¦",
                        "In recent years, there has been an increasing interest in â€¦",
                        "Recent developments in X seems to have heightened the need for â€¦",
                        "The last two decades have seen a growing trend towards â€¦",
                        "Recently, researchers have shown an increased interest in ...",
                        "Over the past century, there has been a dramatic increase in â€¦",
                        "Recent trends in X have led to a proliferation of studies that ...",
                        "X proved an important literary genre in the early Y community.",
                        "The past decade has seen the rapid development of X in many â€¦",
                        "Since it was reported in 2005, X has been attracting a lot of interest.",
                        "A considerable literature has been presented around the theme of â€¦"
                    ]
                },
                {
                    category: "Highlighting an Important Problem",
                    phrases: [
                        "One of the main obstacles â€¦",
                        "One of the greatest challenges â€¦",
                        "A key issue is the safe disposal of â€¦",
                        "The main disadvantage of X is that â€¦",
                        "X is associated with increased risk of â€¦",
                        "X is a common disorder characterised by â€¦",
                        "It is now well established that X can impair â€¦",
                        "X is a common, chronic disease of childhood.",
                        "X has led to the declines in the populations of â€¦",
                        "X is a growing public health concern worldwide.",
                        "X is one of the most frequently stated problems with â€¦"
                    ]
                },
                {
                    category: "Highlighting a Controversy",
                    phrases: [
                        "A much debated question seems to be whether â€¦",
                        "One major issue in early X research concerned ...",
                        "To date there has been little agreement on what ...",
                        "The issue has grown in importance in light of recent ...",
                        "In the literature on X, the relative importance of Y is debated.",
                        "One observer has already drawn attention to the paradox in ...",
                        "Questions have been raised about the use of animal subjects in ...",
                        "In many Xs, a debate is taking place between Ys and Zs concerning ...",
                        "Debate continues about the best strategies for the management of ...",
                        "This concept has recently been challenged by X studies demonstrating ..."
                    ]
                },
                {
                    category: "Focus, Aim, and Argument",
                    phrases: [
                        "This paper argues that ...",
                        "The central thesis of this paper is that ..."
                    ]
                },
                {
                    category: "Stating Research Purpose",
                    phrases: [
                        "The specific objective of this study was to â€¦",
                        "An objective of this study was to investigate ...",
                        "This thesis will examine the way in which the ...",
                        "This study set out to investigate the usefulness of ...",
                        "This dissertation seeks to explain the development of ...",
                        "This case study seeks to examine the changing nature of ...",
                        "The objectives of this research are to determine whether ..."
                    ]
                },
                {
                    category: "Explaining Keywords and Defining Terms",
                    phrases: [
                        "Throughout this paper, the term X will refer to ...",
                        "According to Smith (2002), X can be defined as follows: ' ... '",
                        "In this article, the abbreviation XYZ will be used to refer to ...",
                        "Throughout this dissertation, the term X will be used to refer to ...",
                        "The term X is a relatively new name for ..., commonly referred to as ..."
                    ]
                }
            ];

            const toggleCategory = (category) => {
                setExpandedCategories(prev => ({
                    ...prev,
                    [category]: !prev[category]
                }));
            };

            const addToFavorites = async (phrase, category) => {
                const row = {
                    user_id: currentUser.id,
                    phrase,
                    category,
                    sample: getSampleSentence(phrase)
                };
                const { data, error } = await sb.from('favorites').insert(row).select().single();
                if (!error && data) {
                    setFavorites(prev => [...prev, data]);
                    setSelectedPhrase(data);
                    setTimeout(() => setSelectedPhrase(null), 3000);
                }
            };

            const removeFromFavorites = async (id) => {
                await sb.from('favorites').delete().eq('id', id);
                setFavorites(prev => prev.filter(f => f.id !== id));
            };

            const isFavorite = (phrase) => {
                return favorites.some(f => f.phrase === phrase);
            };

            const filteredPhrases = phrasesData.map(category => ({
                ...category,
                phrases: category.phrases.filter(phrase =>
                    phrase.toLowerCase().includes(searchTerm.toLowerCase())
                )
            })).filter(category => category.phrases.length > 0);

            if (authLoading) return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center">
                    <div className="text-indigo-600 text-lg font-medium animate-pulse">Loadingâ€¦</div>
                </div>
            );

            if (!currentUser) {
                return <AuthShell view={authView} setView={setAuthView} onSuccess={() => {}} />;
            }

            const handleLogout = async () => {
                await sb.auth.signOut();
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100">
                    <div className="bg-indigo-600 text-white p-4 shadow-lg">
                        <div className="flex items-center justify-between">
                            <div>
                                <h1 className="text-2xl font-bold flex items-center gap-2">
                                    <Book className="w-7 h-7" />
                                    Academic Phrases for the Introduction
                                </h1>
                                <p className="text-indigo-100 text-sm mt-1">Master introduction writing with key phrases</p>
                            </div>
                            <div className="flex items-center gap-3">
                                <div className="text-right hidden sm:block">
                                    <div className="text-sm font-medium">{currentUser.user_metadata?.name || 'User'}</div>
                                    <div className="text-indigo-200 text-xs">{currentUser.email}</div>
                                </div>
                                <button
                                    onClick={handleLogout}
                                    title="Sign out"
                                    className="flex items-center gap-1.5 bg-indigo-700 hover:bg-indigo-800 transition px-3 py-2 rounded-lg text-sm font-medium"
                                >
                                    <LogOutIcon className="w-4 h-4" />
                                    <span className="hidden sm:inline">Logout</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div className="bg-white shadow-sm border-b">
                        <div className="flex">
                            <button
                                onClick={() => setActiveTab('browse')}
                                className={`flex-1 py-3 px-4 font-medium transition-colors ${
                                    activeTab === 'browse'
                                        ? 'text-indigo-600 border-b-2 border-indigo-600'
                                        : 'text-gray-600'
                                }`}
                            >
                                Browse Phrases
                            </button>
                            <button
                                onClick={() => setActiveTab('favorites')}
                                className={`flex-1 py-3 px-4 font-medium transition-colors flex items-center justify-center gap-2 ${
                                    activeTab === 'favorites'
                                        ? 'text-indigo-600 border-b-2 border-indigo-600'
                                        : 'text-gray-600'
                                }`}
                            >
                                <Star className="w-4 h-4" />
                                My Favorites ({favorites.length})
                            </button>
                        </div>
                    </div>

                    {selectedPhrase && (
                        <div className="fixed top-20 left-1/2 transform -translate-x-1/2 z-50 bg-green-500 text-white px-6 py-3 rounded-lg shadow-xl animate-bounce">
                            âœ“ Added to favorites!
                        </div>
                    )}

                    {activeTab === 'browse' && (
                        <div className="p-4">
                            <div className="mb-4">
                                <div className="relative">
                                    <Search className="absolute left-3 top-3 text-gray-400 w-5 h-5" />
                                    <input
                                        type="text"
                                        placeholder="Search phrases..."
                                        value={searchTerm}
                                        onChange={(e) => setSearchTerm(e.target.value)}
                                        className="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                                    />
                                </div>
                            </div>

                            <div className="space-y-3">
                                {filteredPhrases.map((category, idx) => (
                                    <div key={idx} className="bg-white rounded-lg shadow-sm overflow-hidden">
                                        <button
                                            onClick={() => toggleCategory(category.category)}
                                            className="w-full px-4 py-4 flex items-center justify-between bg-gradient-to-r from-indigo-50 to-blue-50 hover:from-indigo-100 hover:to-blue-100 transition-colors"
                                        >
                                            <span className="font-semibold text-gray-800 text-left">
                                                {category.category}
                                            </span>
                                            <div className="flex items-center gap-2">
                                                <span className="text-xs bg-indigo-600 text-white px-2 py-1 rounded-full">
                                                    {category.phrases.length}
                                                </span>
                                                {expandedCategories[category.category] ? (
                                                    <ChevronUp className="w-5 h-5 text-indigo-600" />
                                                ) : (
                                                    <ChevronDown className="w-5 h-5 text-indigo-600" />
                                                )}
                                            </div>
                                        </button>
                                        
                                        {expandedCategories[category.category] && (
                                            <div className="p-3 space-y-2">
                                                {category.phrases.map((phrase, pIdx) => (
                                                    <div
                                                        key={pIdx}
                                                        className="flex items-start justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors"
                                                    >
                                                        <span className="text-gray-700 flex-1">{phrase}</span>
                                                        <button
                                                            onClick={() => addToFavorites(phrase, category.category)}
                                                            disabled={isFavorite(phrase)}
                                                            className={`ml-3 p-2 rounded-full transition-all ${
                                                                isFavorite(phrase)
                                                                    ? 'bg-pink-100 text-pink-600 cursor-not-allowed'
                                                                    : 'bg-white text-gray-400 hover:bg-pink-50 hover:text-pink-600'
                                                            }`}
                                                        >
                                                            <Heart
                                                                className="w-5 h-5"
                                                                fill={isFavorite(phrase) ? 'currentColor' : 'none'}
                                                            />
                                                        </button>
                                                    </div>
                                                ))}
                                            </div>
                                        )}
                                    </div>
                                ))}
                            </div>
                        </div>
                    )}

                    {activeTab === 'favorites' && (
                        <div className="p-4">
                            {favorites.length === 0 ? (
                                <div className="text-center py-12">
                                    <Heart className="w-16 h-16 text-gray-300 mx-auto mb-4" />
                                    <p className="text-gray-500 text-lg">No favorites yet</p>
                                    <p className="text-gray-400 text-sm mt-2">
                                        Add phrases from the Browse tab to see them here
                                    </p>
                                </div>
                            ) : (
                                <div className="space-y-4">
                                    <EmailFavoritesButton user={currentUser} />
                                    {favorites.map((favorite) => (
                                        <div key={favorite.id} className="bg-white rounded-lg shadow-md p-4">
                                            <div className="flex items-start justify-between mb-3">
                                                <div className="flex-1">
                                                    <div className="text-xs text-indigo-600 font-medium mb-1">
                                                        {favorite.category}
                                                    </div>
                                                    <div className="text-gray-800 font-medium mb-2">
                                                        {favorite.phrase}
                                                    </div>
                                                </div>
                                                <button
                                                    onClick={() => removeFromFavorites(favorite.id)}
                                                    className="ml-3 p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-full transition-colors"
                                                >
                                                    <X className="w-5 h-5" />
                                                </button>
                                            </div>
                                            
                                            <div className="bg-indigo-50 rounded-lg p-3 border-l-4 border-indigo-400">
                                                <div className="text-xs text-indigo-700 font-semibold mb-1">
                                                    EXAMPLE:
                                                </div>
                                                <div className="text-sm text-gray-700 italic">
                                                    {favorite.sample}
                                                </div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            )}
                        </div>
                    )}
                </div>
            );
        };

        ReactDOM.render(<AcademicPhrasesApp />, document.getElementById('root'));
    </script>
</body>
</html>